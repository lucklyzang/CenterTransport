webpackJsonp([17],{GnQR:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("4YfN"),i=s.n(a),n=s("0eBz"),o=s("SJI6"),d=s("fFvN"),h=s("fdFc"),c={name:"dispatchTaskJudge",data:function(){return{showIsGoOtherDestination:!1,endTaskShow:!1}},components:{HeaderTop:n.a},mounted:function(){this.showEndTaskBtn?this.endTaskShow=!0:(this.judgeIsGoOtherDestination(),Object(h.b)()||(pushHistory(),this.gotoURL(function(){pushHistory()})))},computed:i()({},Object(o.mapGetters)(["navTopTitle","isBack","isSingleDestination","dispatchTaskDepartmentType","isCompleteSweepCode","dispatchTaskMessage","dispatchTaskState","showEndTaskBtn","isCompleteSweepCodeDestinationList"]),{proId:function(){return JSON.parse(Object(h.l)("userInfo")).extendData.proId},proName:function(){return JSON.parse(Object(h.l)("userInfo")).extendData.proName},taskId:function(){return this.dispatchTaskMessage.id}}),methods:i()({},Object(o.mapMutations)(["changeTitleTxt","changeisCompleteSweepCode","changeShowEndTaskBtn","changeIsCompleteSweepCodeDestinationList"]),{judgeIsSingleDestination:function(){this.showIsGoOtherDestination=!0,this.isSingleDestination?this.updateTaskState({proId:this.proId,id:this.dispatchTaskMessage.id,state:this.dispatchTaskState}):this.endTaskShow=!0},judgeIsGoOtherDestination:function(){this.$router.push({path:"/dispatchTaskSweepCode"}),this.changeTitleTxt({tit:"扫码"}),Object(h.q)("currentTitle","扫码")},judgeIsGoDeparture:function(){1==this.isBack?this.updateTaskState({proId:this.proId,id:this.dispatchTaskMessage.id,state:4}):this.judgeIsSingleDestination()},judgeEndTask:function(){this.$dialog.alert({message:"请手动结束任务"}).then(function(){})},backTo:function(){this.endTaskShow?this.judgeEndTask():(this.$router.push({path:"/dispatchTaskSweepCode"}),this.changeTitleTxt({tit:"扫码"}),Object(h.q)("currentTitle","扫码"))},updateTaskState:function(t){var e=this;Object(d.K)(t).then(function(t){if(t&&200==t.data.code){if(1==e.dispatchTaskDepartmentType&&e.isSingleDestination&&4!=e.dispatchTaskState||7==e.dispatchTaskState){e.$dialog.alert({message:"该条任务已完成",closeOnPopstate:!0}).then(function(){});var s=Object(h.j)(e.isCompleteSweepCodeDestinationList);s=s.filter(function(t){return t.taskId!=e.taskId}),e.changeIsCompleteSweepCodeDestinationList(s),Object(h.q)("completeDispatchSweepCodeDestinationInfo",{sweepCodeInfo:s})}var a=Object(h.j)(e.isCompleteSweepCode);a=a.filter(function(t){return t.taskId!=e.taskId}),e.changeisCompleteSweepCode(a),Object(h.q)("completeDispatchSweepCodeInfo",{sweepCodeInfo:a}),e.endTaskShow&&(e.endTaskShow=!1,e.changeShowEndTaskBtn(!1)),e.$router.push({path:"/dispatchTask"}),e.changeTitleTxt({tit:"调度任务"}),Object(h.q)("currentTitle","调度任务")}else e.$dialog.alert({message:t.data.msg,closeOnPopstate:!0}).then(function(){})}).catch(function(t){e.$dialog.alert({message:""+t.message,closeOnPopstate:!0}).then(function(){})})},endTask:function(){this.updateTaskState({proId:this.proId,id:this.dispatchTaskMessage.id,state:this.dispatchTaskState})}})},p={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"content-wrapper"},[e("HeaderTop",{attrs:{title:this.navTopTitle}},[e("van-icon",{attrs:{slot:"left",name:"arrow-left"},on:{click:this.backTo},slot:"left"})],1),this._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:this.endTaskShow,expression:"endTaskShow"}],staticClass:"btn-area"},[e("van-button",{attrs:{type:"info"},on:{click:this.endTask}},[this._v("结束任务")])],1)],1)},staticRenderFns:[]};var r=s("C7Lr")(c,p,!1,function(t){s("ln26")},"data-v-7540abbe",null);e.default=r.exports},ln26:function(t,e){}});