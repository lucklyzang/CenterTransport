webpackJsonp([5],{Gv5q:function(e,t,s){s("VZ9x"),e.exports=s("ZuHZ").Object.values},KkUl:function(e,t,s){var a=s("uoC7"),n=s("RY2v"),i=s("KKnT"),c=s("2raJ").f;e.exports=function(e){return function(t){for(var s,l=i(t),o=n(l),r=o.length,u=0,p=[];r>u;)s=o[u++],a&&!c.call(l,s)||p.push(e?[s,l[s]]:l[s]);return p}}},MgeX:function(e,t,s){e.exports={default:s("Gv5q"),__esModule:!0}},VZ9x:function(e,t,s){var a=s("Wtcz"),n=s("KkUl")(!1);a(a.S,"Object",{values:function(e){return n(e)}})},cY62:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("MgeX"),n=s.n(a),i=s("4YfN"),c=s.n(i),l=s("0eBz"),o=s("yl8L"),r=s("gh9j"),u=s("0DTB"),p=s("fFvN"),m=s("sqAx"),g=s("upvi"),h=s("fdFc"),d=(s("M9A7"),{data:function(){return{leftDropdownDataList:["退出登录"],leftDownShow:!1,showSignatureBox:!1,isClickCancelBtn:!1,liIndex:null,isDialogShow:!1,showSignature:!1,allcirculationCollectMessageList:[],bedNumber:"",patientName:"",sampleAmount:"",sampleMessageList:[{sampleType:"",innerSampleAmount:"",sampleTypeList:[],entryList:[],checkEntryList:[]}],temporaryCollectInfo:[],taskSurePng:s("WoXg"),taskCancelPng:s("faDW")}},components:{VanFieldSelectPicker:o.a,HeaderTop:l.a,NoData:m.a,FooterBottom:u.a,ElectronicSignature:r.a},mounted:function(){var e=this;console.log("id",this.circulationTaskId),Object(h.b)()||(pushHistory(),this.gotoURL(function(){pushHistory(),e.isDialogShow?e.showSignatureBox||e.signatureInfo():e.loseDataInfo()})),this.echoCollectMessage()},computed:c()({},Object(g.b)(["navTopTitle","currentElectronicSignature","circulationCollectMessageList","circulationTaskMessage","completeDeparnmentInfo"]),{proId:function(){return JSON.parse(Object(h.j)("userInfo")).extendData.proId},circulationTaskId:function(){return this.circulationTaskMessage.currentMsg.id},departmentId:function(){return this.circulationTaskMessage.officeId}}),methods:c()({},Object(g.c)(["changeTitleTxt","changeCirculationCollectMessageList","changeCompleteDeparnmentInfo","changeCurrentElectronicSignature"]),{skipMyInfo:function(){},loseDataInfo:function(){var e=this;this.isDialogShow=!1,this.showSignatureBox=!0,this.$dialog.alert({message:"返回上级后,将丢失本页及本科室的数据",closeOnPopstate:!1,showCancelButton:!0}).then(function(){e.temporaryCollectInfo=Object(h.h)(e.circulationCollectMessageList.filter(function(t){return t.taskId!=e.circulationTaskId})),e.changeCurrentElectronicSignature({DtMsg:null}),e.changeCirculationCollectMessageList({DtMsg:e.temporaryCollectInfo}),Object(h.p)("currentCirculationCollectMessage",{innerMessage:e.temporaryCollectInfo}),e.$router.push({path:"/circulationTaskCollectMessage"}),e.changeTitleTxt({tit:"循环信息采集"}),Object(h.p)("currentTitle","循环信息采集"),e.isDialogShow=!0,e.showSignatureBox=!0}).catch(function(){e.isDialogShow=!1,e.showSignatureBox=!0})},signatureInfo:function(){var e=this;this.isClickCancelBtn=!1,this.isDialogShow=!0,this.showSignatureBox=!1,this.$dialog.alert({message:"请医生签字",closeOnPopstate:!1,showCancelButton:!0}).then(function(){e.showSignature=!0,e.isDialogShow=!1,e.showSignatureBox=!0}).catch(function(){e.isDialogShow=!1,e.showSignatureBox=!0,e.isClickCancelBtn=!0})},updateCirculationtaskState:function(e){var t=this;Object(p.B)(e).then(function(e){e&&e.data.code}).catch(function(e){t.$dialog.alert({message:""+e.message,closeOnPopstate:!1}).then(function(){})})},echoCollectMessage:function(){var e=this;this.allcirculationCollectMessageList=[];var t=this.circulationCollectMessageList.indexOf(this.circulationCollectMessageList.filter(function(t){return t.taskId==e.circulationTaskId})[0]);this.allcirculationCollectMessageList=Object(h.h)(this.circulationCollectMessageList[t].collectDepartmentList)},getSampleMessage:function(e){var t=this;Object(p.c)(e).then(function(e){if(e&&200==e.data.code){t.$dialog.alert({message:e.data.msg,closeOnPopstate:!0}).then(function(){}),t.allcirculationCollectMessageList=[],t.temporaryCollectInfo=Object(h.h)(t.circulationCollectMessageList.filter(function(e){return e.taskId!=t.circulationTaskId})),t.changeCurrentElectronicSignature({DtMsg:null}),t.changeCirculationCollectMessageList({DtMsg:t.temporaryCollectInfo}),Object(h.p)("currentCirculationCollectMessage",{innerMessage:t.temporaryCollectInfo});var s=[],a=[];a=Object(h.h)(t.completeDeparnmentInfo);var n=t.completeDeparnmentInfo.indexOf(t.completeDeparnmentInfo.filter(function(e){return e.taskId==t.circulationTaskId})[0]);t.completeDeparnmentInfo.length>0&&-1!=n?((s=a[n].departmentIdList).push(t.departmentId),a[n].departmentIdList=s):(s.push(t.departmentId),a.push({departmentIdList:s,taskId:t.circulationTaskId})),t.changeCompleteDeparnmentInfo({DtMsg:a}),Object(h.p)("completeDepartmentMessage",{sureInfo:a}),t.$router.push({path:"/circulationTask"}),t.changeTitleTxt({tit:"循环任务"}),Object(h.p)("currentTitle","循环任务")}else t.$dialog.alert({message:e.data.msg,closeOnPopstate:!1}).then(function(){})}).catch(function(e){t.$dialog.alert({message:""+e.message,closeOnPopstate:!1}).then(function(){})})},backTo:function(){this.loseDataInfo()},collectMessageSure:function(){var e=this;if(this.showSignatureBox&&!this.isClickCancelBtn)if(this.currentElectronicSignature){var t={proId:this.proId,taskId:this.circulationTaskId,departmentId:this.departmentId,singImg:this.currentElectronicSignature,specList:[]},s=this.circulationCollectMessageList.indexOf(this.circulationCollectMessageList.filter(function(t){return t.taskId==e.circulationTaskId})[0]),a=Object(h.h)(this.circulationCollectMessageList[s].collectDepartmentList);if(a.length>0){for(var i=0,c=a.length;i<c;i++)if(t.specList.push({patientName:a[i].patientName,bedNumber:a[i].bedNumber,totalNum:a[i].sampleAmount,specimen:[]}),a[i].sampleMessageList.length>0)for(var l=0,o=a[i].sampleMessageList.length;l<o;l++)if(t.specList[i].specimen.push({specimenId:a[i].sampleMessageList[l].sampleType,specimenName:Object(h.k)(JSON.parse(Object(h.j)("sampleInfo")).sampleKey,a[i].sampleMessageList[l].sampleType),quantity:a[i].sampleMessageList[l].innerSampleAmount,checkItems:{}}),a[i].sampleMessageList[l].checkEntryList.length>0)for(var r=0,u=a[i].sampleMessageList[l].checkEntryList.length;r<u;r++){var p=n()(JSON.parse(a[i].sampleMessageList[l].checkEntryList[r]));t.specList[i].specimen[l].checkItems[p[0]]=p[1]}console.log("最终标本信息",t)}this.getSampleMessage(t)}else this.$dialog.alert({message:"签名不能为空，请确认签名!",closeOnPopstate:!1}).then(function(){});else this.signatureInfo()},collectMessageCancel:function(){var e=this;this.$dialog.alert({message:"取消确认后,将丢失本页及本科室的采集数据",closeOnPopstate:!1,showCancelButton:!0}).then(function(){e.allcirculationCollectMessageList=[],e.temporaryCollectInfo=Object(h.h)(e.circulationCollectMessageList.filter(function(t){return t.taskId!=e.circulationTaskId})),e.changeCurrentElectronicSignature({DtMsg:null}),e.changeCirculationCollectMessageList({DtMsg:e.temporaryCollectInfo}),Object(h.p)("currentCirculationCollectMessage",{innerMessage:e.temporaryCollectInfo}),e.$router.push({path:"/circulationTaskCollectMessage"}),e.changeTitleTxt({tit:"信息采集"}),Object(h.p)("currentTitle","信息采集")}).catch(function(){})}})}),f={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"content-wrapper"},[s("HeaderTop",{attrs:{title:e.navTopTitle}},[s("van-icon",{attrs:{slot:"left",name:"arrow-left"},on:{click:e.backTo},slot:"left"})],1),e._v(" "),s("ul",{directives:[{name:"show",rawName:"v-show",value:e.leftDownShow,expression:"leftDownShow"}],staticClass:"left-dropDown"},e._l(e.leftDropdownDataList,function(t,a){return s("li",{key:a,class:{liStyle:e.liIndex==a},on:{click:function(t){return e.leftLiCLick(a)}}},[e._v(e._s(t))])}),0),e._v(" "),e._m(0),e._v(" "),s("div",{staticClass:"bed-number-list-outer"},e._l(e.allcirculationCollectMessageList,function(t,a){return s("div",{key:t+"-"+a,staticClass:"bed-number-list"},[s("div",{staticClass:"form-two"},[s("van-field",{attrs:{disabled:"",label:"床号"},model:{value:t.bedNumber,callback:function(s){e.$set(t,"bedNumber",s)},expression:"outerItem.bedNumber"}}),e._v(" "),s("van-field",{attrs:{disabled:"",type:"tel",label:"姓名"},model:{value:t.patientName,callback:function(s){e.$set(t,"patientName",s)},expression:"outerItem.patientName"}}),e._v(" "),s("van-field",{attrs:{disabled:"",type:"number",label:"标本总数"},model:{value:t.sampleAmount,callback:function(s){e.$set(t,"sampleAmount",s)},expression:"outerItem.sampleAmount"}})],1),e._v(" "),s("div",{staticClass:"sweep-code-area"},[s("div",{staticClass:"increaseLineArea"},e._l(t.sampleMessageList,function(t,a){return s("div",{key:t+"-"+a,staticClass:"circulation-area"},[s("div",{staticClass:"sample-box"},[s("div",{staticClass:"sample-title"},[e._v("标本类型")]),e._v(" "),s("div",{staticClass:"sample-content"},[s("van-dropdown-menu",[s("van-dropdown-item",{attrs:{disabled:"",options:t.sampleTypeList},model:{value:t.sampleType,callback:function(s){e.$set(t,"sampleType",s)},expression:"item.sampleType"}})],1)],1)]),e._v(" "),s("div",{staticClass:"check-entry-box"},[s("div",{staticClass:"check-entry-title"},[e._v("检查项")]),e._v(" "),s("div",{staticClass:"check-entry-content"},[s("van-checkbox-group",{attrs:{direction:"horizontal"},model:{value:t.checkEntryList,callback:function(s){e.$set(t,"checkEntryList",s)},expression:"item.checkEntryList"}},e._l(t.entryList,function(t,a){return s("van-checkbox",{key:t+"-"+a,attrs:{disabled:"",shape:"quare",name:'{"id":"'+t.id+'","itemName":"'+t.itemName+'"}'}},[e._v("\n                          "+e._s(t.itemName)+"\n                        ")])}),1)],1)]),e._v(" "),s("div",{staticClass:"inner-sample--number-box"},[s("div",{staticClass:"inner-sample--number-title"},[e._v("数量")]),e._v(" "),s("div",{staticClass:"inner-sample--number-content"},[s("van-field",{attrs:{type:"number",placeholder:"请输入该标本数量"},model:{value:t.innerSampleAmount,callback:function(s){e.$set(t,"innerSampleAmount",s)},expression:"item.innerSampleAmount"}})],1)])])}),0)])])}),0),e._v(" "),e.showSignature?s("div",{staticClass:"electronic-signature"},[s("ElectronicSignature")],1):e._e(),e._v(" "),s("div",{staticClass:"btn-area"},[s("span",[s("img",{attrs:{src:e.taskSurePng,alt:""},on:{click:e.collectMessageSure}})]),e._v(" "),s("span",[s("img",{attrs:{src:e.taskCancelPng,alt:""},on:{click:e.collectMessageCancel}})])])],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"sweep-code-title"},[t("h3",[this._v("科室信息采集确认")])])}]};var v=s("C7Lr")(d,f,!1,function(e){s("eqTF")},"data-v-6e5faf57",null);t.default=v.exports},eqTF:function(e,t){}});