webpackJsonp([21],{AsxW:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("3cXf"),n=a.n(s),i=a("HzJ8"),o=a.n(i),l=a("4YfN"),c=a.n(l),r=a("0eBz"),p=a("yl8L"),m=a("0DTB"),h=a("fFvN"),u=a("sqAx"),g=a("NxGh"),v=a("upvi"),d=a("fdFc"),f=(a("M9A7"),{data:function(){return{showLoadingHint:!1,noDataShow:!1,noConnectSampleShow:!1,leftDropdownDataList:["退出登录"],leftDownShow:!1,connectMessageArea:!1,liIndex:null,originCollectSampleMessageList:[],allSampleTypeList:[],manageSampleDataList:[],taskSurePng:a("WoXg"),taskCancelPng:a("faDW")}},components:{VanFieldSelectPicker:p.a,HeaderTop:r.a,NoData:u.a,Loading:g.a,FooterBottom:m.a},mounted:function(){var e=this;Object(d.b)()||(pushHistory(),this.gotoURL(function(){pushHistory(),e.noConnectSampleShow?e.noConnectSampleInfo():(e.$router.push({path:"/circulationTask"}),e.changeTitleTxt({tit:"循环任务"}),Object(d.o)("currentTitle","循环任务"))})),this.getCollectSampleMessage(this.proId,this.arriveCirculationTaskId)},activated:function(){var e=this;Object(d.b)()||(pushHistory(),this.gotoURL(function(){pushHistory(),e.noConnectSampleShow?e.noConnectSampleInfo():(e.$router.push({path:"/circulationTask"}),e.changeTitleTxt({tit:"循环任务"}),Object(d.o)("currentTitle","循环任务"))})),this.isrefreshCirculationConnectPage&&this.getCollectSampleMessage(this.proId,this.arriveCirculationTaskId)},computed:c()({},Object(v.b)(["navTopTitle","isrefreshCirculationConnectPage","arriveCirculationTaskId","storeNoConnectSample","storeAlreadyConnectSample","completeDeparnmentInfo"]),{proId:function(){return JSON.parse(Object(d.i)("userInfo")).extendData.proId}}),methods:c()({},Object(v.c)(["changeTitleTxt","changeCirculationConnectMessageList","changeIsStoreNoConnectSample","changeCompleteDeparnmentInfo"]),{leftLiCLick:function(e){this.liIndex=e,localStorage.clear(),this.$router.push({path:"/"})},skipMyInfo:function(){this.leftDownShow=!this.leftDownShow},noConnectSampleInfo:function(){var e=this;this.noConnectSampleShow=!0,this.$dialog.alert({message:"该条循环任务没有需要交接的标本,确定后将更新该循环任务状态为已完成",closeOnPopstate:!1}).then(function(){e.dealNoSampleMessage()})},backTo:function(){this.$router.push({path:"/circulationTask"}),this.changeTitleTxt({tit:"循环任务"}),Object(d.o)("currentTitle","循环任务")},dealNoSampleMessage:function(){var e=this;Object(h.B)({proId:this.proId,id:this.arriveCirculationTaskId,state:7}).then(function(t){if(t&&200==t.data.code){e.$dialog.alert({message:"该条循环任务已经完成",closeOnPopstate:!0}).then(function(){}),e.noConnectSampleShow=!1,e.noDataShow=!1;var a=Object(d.g)(e.completeDeparnmentInfo);a=a.filter(function(t){return t.taskId!=e.arriveCirculationTaskId}),e.changeCompleteDeparnmentInfo({DtMsg:a}),Object(d.o)("completeDepartmentMessage",{sureInfo:a}),e.$router.push({path:"/circulationTask"}),e.changeTitleTxt({tit:"循环任务"}),Object(d.o)("currentTitle","循环任务")}else e.$dialog.alert({message:""+t.data.data,closeOnPopstate:!1}).then(function(){})}).catch(function(t){e.$dialog.alert({message:""+t.message,closeOnPopstate:!1}).then(function(){})})},getCollectSampleMessage:function(e,t){var a=this;this.showLoadingHint=!0,Object(h.r)(e,t).then(function(e){if(e&&200==e.data.code){if(0==e.data.data.length)return a.connectMessageArea=!1,a.noDataShow=!0,void a.noConnectSampleInfo();a.connectMessageArea=!0,a.noDataShow=!1,a.originCollectSampleMessageList=e.data.data,a.allSampleTypeList=[];var t=!0,s=!1,i=void 0;try{for(var l,c=o()(a.originCollectSampleMessageList);!(t=(l=c.next()).done);t=!0){var r=l.value;for(var p in r)"specimenName"===p&&a.allSampleTypeList.push(r[p])}}catch(e){s=!0,i=e}finally{try{!t&&c.return&&c.return()}finally{if(s)throw i}}a.manageSampleDataList=[];for(var m=[],h=[],u=function(e,t){h=[],m=a.originCollectSampleMessageList.filter(function(t){return t.specimenName==Object(d.m)(a.allSampleTypeList)[e]});var s=!0,i=!1,l=void 0;try{for(var c,r=o()(m);!(s=(c=r.next()).done);s=!0){var p=c.value;for(var u in p)"quantity"===u&&h.push(p[u])}}catch(e){i=!0,l=e}finally{try{!s&&r.return&&r.return()}finally{if(i)throw l}}var g=h.reduce(function(e,t,a,s){return e+t});a.manageSampleDataList.push({sampleTypeName:Object(d.m)(a.allSampleTypeList)[e],check:!1,sampleTotal:g,sampleList:Object(d.g)(m)});for(var v=[],f=[],C=0,S=a.manageSampleDataList[e].sampleList.length;C<S;C++){v=[],f=[];var _=a.manageSampleDataList[e].sampleList[C].collectionItem.split(","),k=!0,T=!1,w=void 0;try{for(var y,L=o()(_);!(k=(y=L.next()).done);k=!0){var D=y.value,b=Object(d.k)(D.replace(/\"/g,"")).split(":");v.push({itemName:b[1],id:b[0]}),f.push(n()({itemName:b[1],id:b[0]}))}}catch(e){T=!0,w=e}finally{try{!k&&L.return&&L.return()}finally{if(T)throw w}}a.manageSampleDataList[e].sampleList[C].collectionItem=v,a.manageSampleDataList[e].sampleList[C].checkEntryList=f}},g=0,v=Object(d.m)(a.allSampleTypeList).length;g<v;g++)u(g);a.manageSampleDataList=Object(d.c)(a.manageSampleDataList,a.storeAlreadyConnectSample)}else a.$dialog.alert({message:""+e.data.msg,closeOnPopstate:!1}).then(function(){a.connectMessageArea=!1,a.noDataShow=!0})}).catch(function(e){a.$dialog.alert({message:""+e.message,closeOnPopstate:!1}).then(function(){a.connectMessageArea=!1,a.noDataShow=!0})}),this.showLoadingHint=!1},checkBoxEvent:function(){console.log(this.manageSampleDataList)},ConnectSure:function(){var e=this.manageSampleDataList.filter(function(e){return 1==e.check});this.changeIsStoreNoConnectSample(this.manageSampleDataList.filter(function(e){return 0==e.check})),0!=e.length?(this.changeCirculationConnectMessageList({DtMsg:e}),Object(d.o)("currentCirculationConnectMessage",{innerMessage:e}),this.$router.push({path:"/circulationTaskConnectMessageSure"}),this.changeTitleTxt({tit:"交接信息确认"}),Object(d.o)("currentTitle","交接信息确认")):this.$dialog.alert({message:"请选择要交接的标本",closeOnPopstate:!0}).then(function(){})},ConnectCancel:function(){this.$router.push({path:"/circulationTask"}),this.changeTitleTxt({tit:"循环任务"}),Object(d.o)("currentTitle","循环任务")}})}),C={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content-wrapper"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.noDataShow,expression:"noDataShow"}],staticClass:"no-data"},[a("NoData")],1),e._v(" "),a("div",{staticClass:"loading"},[a("loading",{attrs:{isShow:e.showLoadingHint,textContent:"加载中,请稍候····",textColor:"#2895ea"}})],1),e._v(" "),a("HeaderTop",{attrs:{title:e.navTopTitle}},[a("van-icon",{attrs:{slot:"left",name:"arrow-left"},on:{click:e.backTo},slot:"left"})],1),e._v(" "),a("ul",{directives:[{name:"show",rawName:"v-show",value:e.leftDownShow,expression:"leftDownShow"}],staticClass:"left-dropDown"},e._l(e.leftDropdownDataList,function(t,s){return a("li",{key:s,class:{liStyle:e.liIndex==s},on:{click:function(t){return e.leftLiCLick(s)}}},[e._v(e._s(t))])}),0),e._v(" "),e._m(0),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.connectMessageArea,expression:"connectMessageArea"}],staticClass:"sweep-code-area"},e._l(e.manageSampleDataList,function(t,s){return a("div",{key:t+"-"+s,staticClass:"sample-type-list"},[a("div",{staticClass:"sample-type-title-wrapper"},[a("div",{staticClass:"sample-type-check"},[a("van-checkbox",{on:{click:e.checkBoxEvent},model:{value:t.check,callback:function(a){e.$set(t,"check",a)},expression:"item.check"}})],1),e._v(" "),a("div",{staticClass:"sample-type-title"},[e._v(e._s(t.sampleTypeName))]),e._v(" "),a("div",{staticClass:"sample-type-total"},[e._v(e._s(t.sampleTotal))])]),e._v(" "),a("div",{staticClass:"sample-type-message-wrapper"},e._l(t.sampleList,function(t,s){return a("div",{key:t+"-"+s,staticClass:"sample-type-message-list"},[a("div",{staticClass:"sample-type-message-list-inner-erapper"},[a("p",[a("span",{staticClass:"message-tit"},[e._v("科室:")]),e._v(" "),a("span",{staticClass:"message-tit-real"},[e._v(e._s(t.spaceName))])]),e._v(" "),a("P",[a("span",{staticClass:"message-tit"},[e._v("收集时间:")]),e._v(" "),a("span",{staticClass:"message-tit-real"},[e._v(e._s(t.collectionTime))])])],1),e._v(" "),a("div",{staticClass:"sample-type-message-list-inner-erapper"},[a("p",[a("span",{staticClass:"message-tit"},[e._v("病人姓名:")]),e._v(" "),a("span",{staticClass:"message-tit-real"},[e._v(e._s(t.patientName))])]),e._v(" "),a("P",[a("span",{staticClass:"message-tit"},[e._v("病人床号:")]),e._v(" "),a("span",{staticClass:"message-tit-real"},[e._v(e._s(t.bedNumber))])])],1),e._v(" "),a("div",{staticClass:"sample-type-message-list-inner-erapper"},[a("p",[a("span",{staticClass:"message-tit"},[e._v("标本数量:")]),e._v(" "),a("span",{staticClass:"message-tit-real"},[e._v(e._s(t.quantity))])]),e._v(" "),a("P",[a("span",{staticClass:"message-tit"},[e._v("检查项:")]),e._v(" "),a("span",{staticClass:"message-tit-real"},[a("van-checkbox-group",{attrs:{direction:"horizontal"},model:{value:t.checkEntryList,callback:function(a){e.$set(t,"checkEntryList",a)},expression:"innerItem.checkEntryList"}},e._l(t.collectionItem,function(t,s){return a("van-checkbox",{key:t+"-"+s,attrs:{shape:"quare",name:'{"itemName":"'+t.itemName+'","id":"'+t.id+'"}'}},[e._v("\n                      "+e._s(t.itemName)+"\n                    ")])}),1)],1)])],1)])}),0)])}),0),e._v(" "),a("div",{staticClass:"btn-area"},[a("span",[a("img",{attrs:{src:e.taskSurePng,alt:""},on:{click:e.ConnectSure}})]),e._v(" "),a("span",[a("img",{attrs:{src:e.taskCancelPng,alt:""},on:{click:e.ConnectCancel}})])])],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"sweep-code-title"},[t("h3",[this._v("采集信息交接")])])}]};var S=a("C7Lr")(f,C,!1,function(e){a("eBbK")},"data-v-117968b0",null);t.default=S.exports},eBbK:function(e,t){}});