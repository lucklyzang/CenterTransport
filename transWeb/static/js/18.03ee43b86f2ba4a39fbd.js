webpackJsonp([18],{"2ka0":function(t,e){},GnQR:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("4YfN"),i=s.n(a),n=s("0eBz"),o=s("upvi"),h=s("fFvN"),c=s("fdFc"),d={data:function(){return{showIsGoOtherDestination:!1,endTaskShow:!1}},components:{HeaderTop:n.a},mounted:function(){var t=this;this.showEndTaskBtn?this.endTaskShow=!0:(this.judgeIsGoOtherDestination(),Object(c.b)()||(pushHistory(),this.gotoURL(function(){pushHistory(),t.showIsGoOtherDestination?t.endTaskShow&&t.judgeEndTask():t.judgeIsGoOtherDestination()})))},computed:i()({},Object(o.b)(["navTopTitle","isBack","isSingleDestination","dispatchTaskDepartmentType","isCompleteSweepCode","dispatchTaskMessage","dispatchTaskState","showEndTaskBtn","isCompleteSweepCodeDestinationList"]),{proId:function(){return JSON.parse(Object(c.i)("userInfo")).extendData.proId},proName:function(){return JSON.parse(Object(c.i)("userInfo")).extendData.proName},taskId:function(){return this.dispatchTaskMessage.id}}),methods:i()({},Object(o.c)(["changeTitleTxt","changeisCompleteSweepCode","changeShowEndTaskBtn","changeIsCompleteSweepCodeDestinationList"]),{judgeIsSingleDestination:function(){this.showIsGoOtherDestination=!0,this.isSingleDestination?this.updateTaskState({proId:this.proId,id:this.dispatchTaskMessage.id,state:this.dispatchTaskState}):this.endTaskShow=!0},judgeIsGoOtherDestination:function(){var t=this;this.showIsGoOtherDestination=!1,this.$dialog.confirm({message:"是否要去其它目的地?",closeOnPopstate:!1,confirmButtonText:"是",cancelButtonText:"否"}).then(function(){t.$router.push({path:"/dispatchTaskSweepCode"}),t.changeTitleTxt({tit:"扫码"}),Object(c.o)("currentTitle","扫码")}).catch(function(){t.showIsGoOtherDestination=!0,t.judgeIsGoDeparture()})},judgeIsGoDeparture:function(){1==this.isBack?this.updateTaskState({proId:this.proId,id:this.dispatchTaskMessage.id,state:4}):(this.showIsGoOtherDestination=!0,this.judgeIsSingleDestination())},judgeEndTask:function(){this.showIsGoOtherDestination=!0,this.$dialog.alert({message:"请手动结束任务"}).then(function(){})},backTo:function(){this.endTaskShow?this.judgeEndTask():(this.$router.push({path:"/dispatchTaskSweepCode"}),this.changeTitleTxt({tit:"扫码"}),Object(c.o)("currentTitle","扫码"))},updateTaskState:function(t){var e=this;Object(h.C)(t).then(function(t){if(t&&200==t.data.code){if(1==e.dispatchTaskDepartmentType&&e.isSingleDestination&&4!=e.dispatchTaskState||7==e.dispatchTaskState){e.$dialog.alert({message:"该条任务已完成",closeOnPopstate:!0}).then(function(){});var s=Object(c.g)(e.isCompleteSweepCodeDestinationList);s=s.filter(function(t){return t.taskId!=e.taskId}),e.changeIsCompleteSweepCodeDestinationList(s),Object(c.o)("completeDispatchSweepCodeDestinationInfo",{sweepCodeInfo:s})}var a=Object(c.g)(e.isCompleteSweepCode);a=a.filter(function(t){return t.taskId!=e.taskId}),e.changeisCompleteSweepCode(a),Object(c.o)("completeDispatchSweepCodeInfo",{sweepCodeInfo:a}),e.endTaskShow&&(e.endTaskShow=!1,e.changeShowEndTaskBtn(!1)),e.$router.push({path:"/dispatchTask"}),e.changeTitleTxt({tit:"调度任务"}),Object(c.o)("currentTitle","调度任务")}else e.$dialog.alert({message:t.data.msg,closeOnPopstate:!0}).then(function(){})}).catch(function(t){e.$dialog.alert({message:""+t.message,closeOnPopstate:!0}).then(function(){})})},endTask:function(){this.updateTaskState({proId:this.proId,id:this.dispatchTaskMessage.id,state:this.dispatchTaskState})}})},r={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"content-wrapper"},[e("HeaderTop",{attrs:{title:this.navTopTitle}},[e("van-icon",{attrs:{slot:"left",name:"arrow-left"},on:{click:this.backTo},slot:"left"})],1),this._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:this.endTaskShow,expression:"endTaskShow"}],staticClass:"btn-area"},[e("van-button",{attrs:{type:"info"},on:{click:this.endTask}},[this._v("结束任务")])],1)],1)},staticRenderFns:[]};var p=s("C7Lr")(d,r,!1,function(t){s("2ka0")},"data-v-3ac1f54c",null);e.default=p.exports}});