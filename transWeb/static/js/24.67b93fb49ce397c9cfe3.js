webpackJsonp([24],{oO57:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o("4YfN"),i=o.n(n),a=o("0eBz"),s=o("0DTB"),c=o("fFvN"),r=o("sqAx"),d=o("NxGh"),h=o("SJI6"),p=o("fdFc"),f=(o("M9A7"),{name:"appointTaskSweepCode",data:function(){return{leftDropdownDataList:["退出登录"],leftDownShow:!1,showLoadingHint:!1,liIndex:null,departmentId:"",destinationList:[],taskCancelPng:o("faDW"),taskSweepCodePng:o("g5KD")}},components:{HeaderTop:a.a,NoData:r.a,Loading:d.a,FooterBottom:s.a},mounted:function(){var e=this;if(!Object(p.b)()){pushHistory(),this.gotoURL(function(){pushHistory(),e.backTo()})}var t=this;window.scanQRcodeCallback=function(e){t.scanQRcodeCallback(e)},window.scanQRcodeCallbackCanceled=function(){t.scanQRcodeCallbackCanceled()},this.sweepAstoffice(),console.log("信息校验",this.appointTaskMessage)},computed:i()({},Object(h.mapGetters)(["userInfo","navTopTitle","appointTaskMessage","completeSweepcodeDestinationInfo","completeSweepcodeDepartureInfo"]),{proId:function(){return JSON.parse(Object(p.l)("userInfo")).extendData.proId},taskId:function(){return this.appointTaskMessage.id},workerId:function(){return this.userInfo.extendData.userId},checkType:function(){return this.$route.query.checkType},checkId:function(){return this.$route.query.id}}),methods:i()({},Object(h.mapMutations)(["changeTitleTxt","changeCompleteSweepcodeDestinationInfo","changeCompleteSweepcodeDepartureInfo"]),{scanQRcodeCallbackCanceled:function(){this.backTo()},leftLiCLick:function(e){this.liIndex=e,localStorage.clear(),this.$router.push({path:"/"})},skipMyInfo:function(){this.leftDownShow=!this.leftDownShow},scanQRcodeCallback:function(e){var t=this;if(e)if(0!=this.checkType){var o=e.split("|");if(o.length>0){this.departmentId=o[0];var n=o[1];if(1==this.checkType||3==this.checkType)this.checkDepartmentVerify({proId:this.proId,workerId:this.workerId,taskId:this.taskId,departmentNo:n},this.checkType);else try{this.checkItemVerify({proId:this.proId,workerId:this.workerId,itemId:this.checkId,departmentNo:n})}catch(e){this.$dialog.alert({message:""+e}).then(function(){})}}}else{var i=e.split("|");i.length>0&&this.checkPatientVerify({proId:this.proId,workerId:this.workerId,taskId:this.taskId,patient:i[1]})}else this.$dialog.alert({message:"当前没有扫描到任何信息,请重新扫描"}).then(function(){t.sweepAstoffice()})},checkItemVerify:function(e){var t=this;this.showLoadingHint=!0,Object(c.p)(e).then(function(e){if(e&&200==e.data.code)try{var o=[],n=[];if(o=Object(p.j)(t.completeSweepcodeDestinationInfo),t.completeSweepcodeDestinationInfo.length>0){var i=t.completeSweepcodeDestinationInfo.indexOf(t.completeSweepcodeDestinationInfo.filter(function(e){return e.taskId==t.taskId})[0]);-1!=i?((n=o[i].officeList).push(t.checkId),o[i].officeList=Object(p.p)(n)):(n.push(t.checkId),o.push({officeList:Object(p.p)(n),taskId:t.taskId}))}else n.push(t.checkId),o.push({officeList:Object(p.p)(n),taskId:t.taskId});t.changeCompleteSweepcodeDestinationInfo(o),Object(p.q)("completAppointTaskSweepCodeDestinationInfo",{sweepCodeInfo:o}),t.backTo()}catch(e){t.$dialog.alert({message:""+e}).then(function(){})}else t.backTo(),t.$dialog.alert({message:""+e.data.msg,closeOnPopstate:!0}).then(function(){});t.showLoadingHint=!1}).catch(function(e){t.backTo(),t.showLoadingHint=!1,t.$dialog.alert({message:""+e.message,closeOnPopstate:!0}).then(function(){})})},checkDepartmentVerify:function(e,t){var o=this;this.showLoadingHint=!0,Object(c.o)(e).then(function(e){e&&200==e.data.code?(1==t&&(o.storeDepartureInfo(1),o.$router.push({path:"/appointTaskCustomerInfo"}),o.changeTitleTxt({tit:"病人信息确认"}),Object(p.q)("currentTitle","病人信息确认")),3==t&&(o.storeDepartureInfo(3),o.backTo())):(o.backTo(),o.$dialog.alert({message:""+e.data.msg,closeOnPopstate:!0}).then(function(){})),o.showLoadingHint=!1}).catch(function(e){o.backTo(),o.showLoadingHint=!1,o.$dialog.alert({message:""+e.message,closeOnPopstate:!0}).then(function(){})})},checkPatientVerify:function(e){var t=this;this.showLoadingHint=!0,Object(c.q)(e).then(function(e){e&&200==e.data.code?(t.storeDepartureInfo(0),t.backTo()):(t.backTo(),t.$dialog.alert({message:""+e.data.msg,closeOnPopstate:!0}).then(function(){})),t.showLoadingHint=!1}).catch(function(e){t.showLoadingHint=!1,t.backTo(),t.$dialog.alert({message:""+e.message,closeOnPopstate:!0}).then(function(){})})},storeDepartureInfo:function(e){var t=this,o=Object(p.j)(this.completeSweepcodeDepartureInfo);if(this.completeSweepcodeDepartureInfo.length>0){var n=this.completeSweepcodeDepartureInfo.indexOf(this.completeSweepcodeDepartureInfo.filter(function(e){return e.taskId==t.taskId})[0]);-1!=n?(0==e&&(o[n].patienVerified=!0),1==e&&(o[n].startPonitVerified=!0),3==e&&(o[n].backStartPonitVerified=!0)):(0==e&&o.push({taskId:this.taskId,patienVerified:!0}),1==e&&o.push({taskId:this.taskId,startPonitVerified:!0}),3==e&&o.push({taskId:this.taskId,backStartPonitVerified:!0}))}else 0==e&&o.push({taskId:this.taskId,patienVerified:!0}),1==e&&o.push({taskId:this.taskId,startPonitVerified:!0}),3==e&&o.push({taskId:this.taskId,backStartPonitVerified:!0});this.changeCompleteSweepcodeDepartureInfo(o),Object(p.q)("completAppointTaskSweepCodeDepartureInfo",{sweepCodeInfo:o})},backTo:function(){this.$router.push({path:"/appointDetails"}),this.changeTitleTxt({tit:"预约任务详情"}),Object(p.q)("currentTitle","预约任务详情")},againSweepCode:function(){this.sweepAstoffice()},sweepAstoffice:function(){window.android.scanQRcode()},sweepCodeSure:function(){this.sweepAstoffice()},cancelSweepCode:function(){this.backTo()}})}),l={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"content-wrapper"},[t("HeaderTop",{attrs:{title:this.navTopTitle}},[t("van-icon",{attrs:{slot:"left",name:"arrow-left"},on:{click:this.backTo},slot:"left"})],1),this._v(" "),t("div",{staticClass:"loading"},[t("loading",{attrs:{isShow:this.showLoadingHint,textContent:"校验中,请稍候····",textColor:"#2895ea"}})],1)],1)},staticRenderFns:[]};var u=o("C7Lr")(f,l,!1,function(e){o("t41v")},"data-v-10969ec3",null);t.default=u.exports},t41v:function(e,t){}});